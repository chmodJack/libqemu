.\" Man page generated from reStructuredText.
.
.TH "VIRTIOFSD" "1" "Oct 20, 2020" "5.0.0" "QEMU"
.SH NAME
virtiofsd \- QEMU virtio-fs shared file system daemon
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH SYNOPSIS
.sp
\fBvirtiofsd\fP [\fIOPTIONS\fP]
.SH DESCRIPTION
.sp
Share a host directory tree with a guest through a virtio\-fs device.  This
program is a vhost\-user backend that implements the virtio\-fs device.  Each
virtio\-fs device instance requires its own virtiofsd process.
.sp
This program is designed to work with QEMU\(aqs \fB\-\-device vhost\-user\-fs\-pci\fP
but should work with any virtual machine monitor (VMM) that supports
vhost\-user.  See the Examples section below.
.sp
This program must be run as the root user.  Upon startup the program will
switch into a new file system namespace with the shared directory tree as its
root.  This prevents "file system escapes" due to symlinks and other file
system objects that might lead to files outside the shared directory.  The
program also sandboxes itself using seccomp(2) to prevent ptrace(2) and other
vectors that could allow an attacker to compromise the system after gaining
control of the virtiofsd process.
.SH OPTIONS
.INDENT 0.0
.TP
.B \-h, \-\-help
Print help.
.UNINDENT
.INDENT 0.0
.TP
.B \-V, \-\-version
Print version.
.UNINDENT
.INDENT 0.0
.TP
.B \-d
Enable debug output.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-syslog
Print log messages to syslog instead of stderr.
.UNINDENT
.INDENT 0.0
.TP
.B \-o OPTION
.INDENT 7.0
.IP \(bu 2
debug \-
Enable debug output.
.IP \(bu 2
flock|no_flock \-
Enable/disable flock.  The default is \fBno_flock\fP\&.
.IP \(bu 2
log_level=LEVEL \-
Print only log messages matching LEVEL or more severe.  LEVEL is one of
\fBerr\fP, \fBwarn\fP, \fBinfo\fP, or \fBdebug\fP\&.  The default is \fBinfo\fP\&.
.IP \(bu 2
norace \-
Disable racy fallback.  The default is false.
.IP \(bu 2
posix_lock|no_posix_lock \-
Enable/disable remote POSIX locks.  The default is \fBposix_lock\fP\&.
.IP \(bu 2
readdirplus|no_readdirplus \-
Enable/disable readdirplus.  The default is \fBreaddirplus\fP\&.
.IP \(bu 2
source=PATH \-
Share host directory tree located at PATH.  This option is required.
.IP \(bu 2
timeout=TIMEOUT \-
I/O timeout in seconds.  The default depends on cache= option.
.IP \(bu 2
writeback|no_writeback \-
Enable/disable writeback cache. The cache alows the FUSE client to buffer
and merge write requests.  The default is \fBno_writeback\fP\&.
.IP \(bu 2
xattr|no_xattr \-
Enable/disable extended attributes (xattr) on files and directories.  The
default is \fBno_xattr\fP\&.
.UNINDENT
.UNINDENT
.INDENT 0.0
.TP
.B \-\-socket\-path=PATH
Listen on vhost\-user UNIX domain socket at PATH.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-fd=FDNUM
Accept connections from vhost\-user UNIX domain socket file descriptor FDNUM.
The file descriptor must already be listening for connections.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-thread\-pool\-size=NUM
Restrict the number of worker threads per request queue to NUM.  The default
is 64.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-cache=none|auto|always
Select the desired trade\-off between coherency and performance.  \fBnone\fP
forbids the FUSE client from caching to achieve best coherency at the cost of
performance.  \fBauto\fP acts similar to NFS with a 1 second metadata cache
timeout.  \fBalways\fP sets a long cache lifetime at the expense of coherency.
.UNINDENT
.SH EXAMPLES
.sp
Export \fB/var/lib/fs/vm001/\fP on vhost\-user UNIX domain socket
\fB/var/run/vm001\-vhost\-fs.sock\fP:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
host# virtiofsd \-\-socket\-path=/var/run/vm001\-vhost\-fs.sock \-o source=/var/lib/fs/vm001
host# qemu\-system\-x86_64 \e
    \-chardev socket,id=char0,path=/var/run/vm001\-vhost\-fs.sock \e
    \-device vhost\-user\-fs\-pci,chardev=char0,tag=myfs \e
    \-object memory\-backend\-memfd,id=mem,size=4G,share=on \e
    \-numa node,memdev=mem \e
    ...
guest# mount \-t virtiofs myfs /mnt
.ft P
.fi
.UNINDENT
.UNINDENT
.SH AUTHOR
Stefan Hajnoczi <stefanha@redhat.com>, Masayoshi Mizuma <m.mizuma@jp.fujitsu.com>
.SH COPYRIGHT
2020, The QEMU Project Developers
.\" Generated by docutils manpage writer.
.
